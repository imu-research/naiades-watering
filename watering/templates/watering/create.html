{% extends "base.html" %}

{% load i18n %}
{% load static %}

{% block css %}
    <link href="{% static 'css/create.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
    <form action="." method="POST">
        {% csrf_token %}

        <h2>{% trans "New Box setup - Info" %}</h2>

        {% include "util/form-fields.html" %}

        <div id="mapid"></div>

        <form method="post" accept-charset="utf-8" id="map_form">
          <input type="text" name="vertices" value="" id="vertices" />
          <input type="button" name="save" value="Save" id="save" />
        </form>

        <button class="btn btn-primary" type="submit">
            {% trans "Next" %}
        </button>
    </form>
{% endblock %}

{% block js %}
    <script>
        $('#id_address, #id_latitude, #id_longitude')
            {#.attr('disabled', 'disabled');#}
            .closest('.form-group')
            .css('display', 'none');

        $('.form-group input, .form-group select, .form-group textarea').
            addClass('form-control');

        var sensors = {{ sensors|safe }};
        var connected_sensors = {{ connected_sensors|safe }};
        var myOptions = {};
        for(var i=0;i<sensors.length;i++){
            myOptions[sensors[i].serialNumber] = sensors[i].serialNumber+' ('+sensors[i].name+')';
        }
        myOptions["none"] = "No sensor";

        $.each(myOptions, function(val, text) {
            $('#id_refDevice').append( new Option(text,val) );
        });
    </script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAeXisjnsAMK0rYoxNNOPPdtc9JFF7OL_w&libraries=places,drawing"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="{% static 'js/map.js' %}"></script>
{% endblock %}